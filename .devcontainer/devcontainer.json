{
  "name": "ESP-IDF v5.5 (Robust Build)",

  // 1. GIẢI PHÁP:
  // Chúng ta dùng thẳng image chính thức của Espressif
  // đã cài sẵn ESP-IDF v5.5. Cách này bỏ qua
  // "feature" đang bị lỗi.
  "image": "espressif/idf:v5.5",

  // 2. BỔ SUNG:
  // Tự động cài các extension bạn yêu cầu
  // (C/C++, CMake, và Python - rất cần cho idf.py)
  "customizations": {
    "vscode": {
      "extensions": [
        "espressif.esp-idf",
        "ms-vscode.cpptools",
        "ms-vscode.cpptools-extension-pack",
        "ms-vscode.cmake-tools",
        "ms-python.python"
      ]
    }
  },

  // 3. TỰ ĐỘNG HÓA:
  // Tự động thêm lệnh kích hoạt IDF vào terminal
  // để bạn có thể gõ 'idf.py' ngay lập tức.
  "postCreateCommand": "echo 'source /opt/esp/idf/export.sh' >> ~/.bashrc && echo 'Codespace is ready! ESP-IDF is pre-installed.' && sleep infinity",
  
  // Đăng nhập bằng user 'idf' (mặc định của image này)
  "remoteUser": "idf"
}
